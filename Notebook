This directory contains a metabolic model of LUCA. 
This model aims to be as complete as possible and provide a self consistent metabolism and objective functions for analysis.
Various choices will be necessary and explained here in the development of the model that is based on the article by Wimmer et al. 2021 (Energy at Origins: Favorable Thermodynamics of Biosynthetic Reactions in the Last Universal Common Ancestor (LUCA) Frontiers in Microbiology 12:793664 doi: 10.3389/fmicb.2021.793664)

The objective with this metabolic model is to be able to then propose an evolutionary path from earlier models while maintaining a coherent metabolic and catalytic scheme.

Step 1 Convert Wimmers model to an smbl model this is LUCA_clean.sbml that was created by the python code in ../Tables2SBML.ipynb convert to pure python code but fetching external info seems to be imperfect.

Step 2 Convert to a model suitable for FBA and a metabolic model:
	1. Need an objective function so add DNA, RNA, Protein, Membrane and cofactors to define the composition of LUCA. This needs some decisions!
	2. Need to define a catabolism to drive the anabolism and merge with the anabolic reations. This needs some decisions.
	3. Need to define exchanges with the environment to provide raw materials.

1.1 Following Jain et al. 2014 propose a membrane composed of a mixture of polyprenyl ether lipids on glycerol-1-phosphate and fatty acyl ester lipids on glycerol-3-phosphate forming a heterochiral membrane. These then have head groups added by the CDP route including serine, ethanolamine and glycerol.

1.2 Following from bionumbers (BNID 111490) and derived from Niedhardt et al. the composition of the cell (recalculated to remove LPS, peptidoglycan and glycogen) is about:
Protein 60% dry wt
RNA 22%
DNA 3%
Lipids 10%
Metabolites and cofactors 4%
Ions 1%

1.3 Within these we will opt for DNA and RNA 50%GC and 50%AT (an arbitrary choice)

1.4 Proteome composition based on data in Brune et al 2018.
W	1	Y	2	F	6	M	2
L	11	I	6	V	7.5	A	9.5
P	4	G	7.5	C	1	Q	4.5
N	4.5	T	5	S	5	E	6.5
D	5.5	K	4	H	2	R	5.5
For amino acid production arginine depends on acetate production and no recycling in initial pathways

1.5 Add membrane lipid biosynthesis pathway both acyl and isoprenyl - need to use ACP not phosphopantatheine and synth of oleyl-ACP and GGPP todo

1.6 Define metabolites and cofactors for growth 
1.7 Correct define formulae and charges of different compounds and verify reactions are equilibrated.
1.8 Complete as possible external references dGÂ° and KEGG and ec#



AcetylCoA C00024
AcetoacetylCoA C00332
Coenzyme A
HMGCoA C00356
Mevalonate C00418
Mevalonate-5-P C01107
Mevalonate-5-PP C01143
Isopentenyl-PP C00129
Dimethylallyl-PP C00235
GPP C00341
FPP C00448
GGPP C00353

Modifications made
==================
0. Add biomass function based on Bionumbers (BIOMASS)
1. Polymerisation and aggregation reactions
1.1 DNA polymerase
1.2 RNA polymerase
1.3 Protein synthesis from amino-acyl tRNA's
1.4 Lipid aggregation to make membrane
1.5 (TODO) Metabolite aggregation for cytoplasmic pool of cofactors and metabolites
2. Add reactions to produce membrane lipids, a mixture of archael and bacterial style lipids (Article)
2.1 Isoprenoid synthesis pathway (via mevalonate)
2.2 Fatty acid synthesis pathway
3. Some other bits:
3.1 CMP phosphorylation to CTP using ATP
3.2 Pyrophosphate hydrolysis
3.3 Hydrogenase to reduce NAD+
3.4 Acetyl CoA Synthase 
3.5 ApoACP Synthase (RMAN8 2.7.8.7) and Adenosine 3'5' bis phosphate recycling
4. Added exchange reactions (initially with internal compartment)
4.1 H2O, CO2, H+, NH3, H2S, PO4
4.2 Unlimited energy supply (EX_Energy) regenerates ATP for free!!!
4.3 Protein as Pr to simplify.
5. Remove unused reactions
5.1 Miscellaneous e-

Next steps.
1. Automatic recovery and tidying of annotations for reactions and metabolites
1.1 Data Sources
1.1.1 kegg https://www.genome.jp/entry/R00742 -> EC#, RHEA#
1.1.2 kegg https://www.genome.jp/entry/C00001 -> CHEBI, Mass
1.1.3 rhea https://www.rhea-db.org/rhea/11311 -> Directionality, Reagents charges, CHEBI, SMILES etc
1.2 Information desired
1.2.1 Reaction: EC, RHEA, KEGG, directionality, DG0', DG0' uncertainty
1.2.2 Metabolite: KEGG, CHEBI, Formula (fully protonated acids, deprotonated bases), charge pH7, 
2. Addition of modifier species for reactions to indicate cofactors
2.1 Cofactors associated with enzyme. http://www.ebi.ac.uk/thornton-srv/databases/CoFactor/queries.php?ec=1.1.2.10&submit=Go
3. Setup of metabolites based on cofactors and cytoplasmic composition for Biomass function


? Formate reduction RMAN4 - hydrogen or NADH (1.17.1.9)
TODO How to interpret multiple ec-code? should be AND not OR sort them out
lookup cofactor requirement (FeS included) where
CoA, NADH, ATP are in reactions
Bionumbers cytoplasmic composition for metabolites and cofactors based on required fluxes
cnapy does not preserve sbml file (unused bits... InitialConcentration and probably Modifiers)... this will be a problem!
use Enzyme table... (ec-code/Substrates/Products/Modifiers/dG0/Equation)

